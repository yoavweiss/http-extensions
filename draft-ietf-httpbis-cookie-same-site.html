<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Same-Site Cookies</title><script type="application/javascript">
function anchorRewrite() {
  map = { };
  if (window.location.hash.length >= 1) {
    var fragid = window.location.hash.substr(1);
    if (fragid) {
      if (! document.getElementById(fragid)) {
        var prefix = "rfc.";
        var mapped = map[fragid];
        if (mapped) {
          window.location.hash = mapped;
        } else if (fragid.indexOf("section-") == 0) {
          window.location.hash = prefix + "section." + fragid.substring(8);
        } else if (fragid.indexOf("appendix-") == 0) {
          window.location.hash = prefix + "section." + fragid.substring(9);
        } else if (fragid.indexOf("s-") == 0) {
          var postfix = fragid.substring(2);
          if (postfix.startsWith("abstract")) {
            window.location.hash = prefix + postfix;
          } else if (postfix.startsWith("note-")) {
            window.location.hash = prefix + "note." + postfix.substring(5);
          } else {
            window.location.hash = prefix + "section." + postfix;
          }
        } else if (fragid.indexOf("p-") == 0) {
          var r = fragid.substring(2);
          var p = r.indexOf("-");
          if (p >= 0) {
            window.location.hash = prefix + "section." + r.substring(0, p) + ".p." + r.substring(p + 1);
          }
        }
      }
    }  
  }
}
window.addEventListener('hashchange', anchorRewrite);
window.addEventListener('DOMContentLoaded', anchorRewrite);
</script><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"><style type="text/css">
      body {
        padding-top: 80px;
        padding-bottom: 80px;
        position: relative;
      }
      .table.header th, .table.header td {
        border-top: none;
        padding: 0;
      }
      #rfc\.meta {
        width: 40%;
        float: right
      }
      #rfc\.toc > ul li {
        list-style: none;
      }
      .container .nav-sublist {
        padding-left: 20px;
        padding-right: 10px;
        font-size: 90%;
      }
      .container .navbar-brand {
        padding-top: 0;
      }
      .container .nav > li > a {
        padding: 10px 7px 5px 15px;
        display: inline-block;
      }
      .container .nav > li > a + a {
        padding: 10px 15px 5px 7px;
        display: inline-block;
      }
      .container .nav > li > a {
        padding: 5px 10px;
      }
      .filename {
        color: rgb(119, 119, 119);
        font-size: 23px;
        font-weight: normal;
        height: auto;
        line-height: 23px;
      }
      dl {
        margin-left: 1em;
      }
      dl.dl-horizontal: {
        margin-left: 0;
      }
      dl > dt {
        float: left;
        margin-right: 1em;
      }
      dl.nohang > dt {
        float: none;
      }
      dl > dd {
        margin-bottom: .5em;
      }
      dl.compact > dd {
        margin-bottom: 0em;
      }
      dl > dd > dl {
        margin-top: 0.5em;
        margin-bottom: 0em;
      }
      ul.empty {
        list-style-type: none;
      }
      ul.empty li {
        margin-top: .5em;
      }
      td.reference {
        padding-right: 1em;
        vertical-align: top;
      }
      .feedback {
        position: fixed;
        bottom: 5px;
        right: 5px;
      }
      .fbbutton {
        margin-left: 5px;
      }
      h1 a, h2 a, h3 a, h4 a, h5 a, h6 a {
        color: rgb(51, 51, 51);
      }
      span.tt {
        font: 11pt consolas, monospace;
        font-size-adjust: none;
      }
    </style><link rel="Author" href="#rfc.authors"><link rel="Copyright" href="#rfc.copyrightnotice"><link rel="Chapter" title="1 Introduction" href="#rfc.section.1"><link rel="Chapter" title="2 Terminology and notation" href="#rfc.section.2"><link rel="Chapter" title="3 Server Requirements" href="#rfc.section.3"><link rel="Chapter" title="4 User Agent Requirements" href="#rfc.section.4"><link rel="Chapter" title="5 Authoring Considerations" href="#rfc.section.5"><link rel="Chapter" title="6 Privacy Considerations" href="#rfc.section.6"><link rel="Chapter" href="#rfc.section.7" title="7 References"><link rel="Appendix" title="A Changes since draft-ietf-httpbis-cookie-same-site-00" href="#rfc.section.A"><link rel="Appendix" title="B Acknowledgements" href="#rfc.section.B"><meta name="generator" content="https://github.com/mnot/RFCBootstrap XSLT vendor: SAXON 9.1.0.8 from Saxonica http://www.saxonica.com/"><meta name="keywords" content="Cookie"><link rel="schema.dcterms" href="http://purl.org/dc/terms/"><meta name="dcterms.creator" content="West, M."><meta name="dcterms.creator" content="Goodwin, M."><meta name="dcterms.identifier" content="urn:ietf:id:draft-ietf-httpbis-cookie-same-site-latest"><meta name="dcterms.issued" content="2017-10-01"><meta name="dcterms.abstract" content="This document updates RFC6265 by defining a SameSite attribute which allows servers to assert that a cookie ought not to be sent along with cross-site requests. This assertion allows user agents to mitigate the risk of cross-origin information leakage, and provides some protection against cross-site request forgery attacks."><meta name="description" content="This document updates RFC6265 by defining a SameSite attribute which allows servers to assert that a cookie ought not to be sent along with cross-site requests. This assertion allows user agents to mitigate the risk of cross-origin information leakage, and provides some protection against cross-site request forgery attacks."></head><body><div class="container" id="top"><div class="row"><div class="col-md-4 col-md-push-8 hidden-sm hidden-xs" role="navigation"><div class="navbar"><div class="navbar-brand"><a href="#top">Internet-Draft</a></div><br clear="all"><div class=""><div id="rfc..toc"><ul class="nav"><li><a href="#rfc.section.1">1.</a>&nbsp;&nbsp;&nbsp;<a href="#introduction">Introduction</a><ul><li><a href="#rfc.section.1.1">1.1.</a>&nbsp;&nbsp;&nbsp;<a href="#goals">Goals</a></li><li><a href="#rfc.section.1.2">1.2.</a>&nbsp;&nbsp;&nbsp;<a href="#examples">Examples</a></li></ul></li><li><a href="#rfc.section.2">2.</a>&nbsp;&nbsp;&nbsp;<a href="#terminology-and-notation">Terminology and notation</a><ul><li><a href="#rfc.section.2.1">2.1.</a>&nbsp;&nbsp;&nbsp;<a href="#same-site-requests">“Same-site” and “cross-site” Requests</a><ul><li><a href="#rfc.section.2.1.1">2.1.1.</a>&nbsp;&nbsp;&nbsp;<a href="#document-requests">Document-based requests</a></li><li><a href="#rfc.section.2.1.2">2.1.2.</a>&nbsp;&nbsp;&nbsp;<a href="#worker-requests">Worker-based requests</a></li></ul></li></ul></li><li><a href="#rfc.section.3">3.</a>&nbsp;&nbsp;&nbsp;<a href="#server-requirements">Server Requirements</a><ul><li><a href="#rfc.section.3.1">3.1.</a>&nbsp;&nbsp;&nbsp;<a href="#grammar">Grammar</a></li><li><a href="#rfc.section.3.2">3.2.</a>&nbsp;&nbsp;&nbsp;<a href="#semantics-of-the-samesite-attribute-non-normative">Semantics of the “SameSite” Attribute (Non-Normative)</a></li></ul></li><li><a href="#rfc.section.4">4.</a>&nbsp;&nbsp;&nbsp;<a href="#user-agent-requirements">User Agent Requirements</a><ul><li><a href="#rfc.section.4.1">4.1.</a>&nbsp;&nbsp;&nbsp;<a href="#the-samesite-attribute">The “SameSite” attribute</a><ul><li><a href="#rfc.section.4.1.1">4.1.1.</a>&nbsp;&nbsp;&nbsp;<a href="#strict-lax">“Strict” and “Lax” enforcement</a></li></ul></li><li><a href="#rfc.section.4.2">4.2.</a>&nbsp;&nbsp;&nbsp;<a href="#monkey-patching-the-storage-model">Monkey-patching the Storage Model</a></li><li><a href="#rfc.section.4.3">4.3.</a>&nbsp;&nbsp;&nbsp;<a href="#cookie-header">Monkey-patching the “Cookie” header</a></li></ul></li><li><a href="#rfc.section.5">5.</a>&nbsp;&nbsp;&nbsp;<a href="#authoring-considerations">Authoring Considerations</a><ul><li><a href="#rfc.section.5.1">5.1.</a>&nbsp;&nbsp;&nbsp;<a href="#defense-in-depth">Defense in depth</a></li><li><a href="#rfc.section.5.2">5.2.</a>&nbsp;&nbsp;&nbsp;<a href="#top-level-navigations">Top-level Navigations</a></li><li><a href="#rfc.section.5.3">5.3.</a>&nbsp;&nbsp;&nbsp;<a href="#mashups-and-widgets">Mashups and Widgets</a></li></ul></li><li><a href="#rfc.section.6">6.</a>&nbsp;&nbsp;&nbsp;<a href="#privacy-considerations">Privacy Considerations</a><ul><li><a href="#rfc.section.6.1">6.1.</a>&nbsp;&nbsp;&nbsp;<a href="#server-controlled">Server-controlled</a></li><li><a href="#rfc.section.6.2">6.2.</a>&nbsp;&nbsp;&nbsp;<a href="#pervasive-monitoring">Pervasive Monitoring</a></li></ul></li><li><a href="#rfc.section.7">7.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references">References</a><ul><li><a href="#rfc.section.7.1">7.1.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references.1">Normative References</a></li><li><a href="#rfc.section.7.2">7.2.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references.2">Informative References</a></li></ul></li><li><a href="#rfc.section.A">A.</a>&nbsp;&nbsp;&nbsp;<a href="#changes-since-draft-ietf-httpbis-cookie-same-site-00">Changes since draft-ietf-httpbis-cookie-same-site-00</a></li><li><a href="#rfc.section.B">B.</a>&nbsp;&nbsp;&nbsp;<a href="#acknowledgements">Acknowledgements</a></li><li><a href="#rfc.authors">Authors' Addresses</a></li></ul></div></div></div></div><div class="col-md-8 col-md-pull-4 main" role="main"><header><table class="table table-condensed header" id="rfc.headerblock"><tbody><tr><td class="text-left">HTTP Working Group</td><td class="text-right">M. West</td></tr><tr><td class="text-left">Internet-Draft</td><td class="text-right">Google, Inc</td></tr><tr><td class="text-left">Updates: <a href="https://tools.ietf.org/html/rfc6265">6265</a> (if approved)</td><td class="text-right">M. Goodwin</td></tr><tr><td class="text-left">Intended status: Standards Track</td><td class="text-right">Mozilla</td></tr><tr><td class="text-left">Expires: April 4, 2018</td><td class="text-right">October 1, 2017</td></tr></tbody></table><div id="rfc.title"><h1>Same-Site Cookies</h1><div class="filename">draft-ietf-httpbis-cookie-same-site-latest</div></div></header><hr><h2 id="rfc..abstract"><a href="#rfc..abstract">Abstract</a></h2><div class="lead"><div id="rfc.abstract.p.1"><p>This document updates RFC6265 by defining a <span class="tt">SameSite</span> attribute which allows servers to assert that a cookie ought not to be sent along with cross-site requests. This assertion allows user agents to mitigate the risk of cross-origin information leakage, and provides some protection against cross-site request forgery attacks.</p></div></div><section id="rfc.note.1" class="note"><h2><a href="#rfc.note.1">Note to Readers</a></h2><div id="rfc.note.1.p.1"><p>Discussion of this draft takes place on the HTTP working group mailing list (ietf-http-wg@w3.org), which is archived at <a href="https://lists.w3.org/Archives/Public/ietf-http-wg/">https://lists.w3.org/Archives/Public/ietf-http-wg/</a>.</p></div><div id="rfc.note.1.p.2"><p>Working Group information can be found at <a href="http://httpwg.github.io/">http://httpwg.github.io/</a>; source code and issues list for this draft can be found at <a href="https://github.com/httpwg/http-extensions/labels/cookie-same-site">https://github.com/httpwg/http-extensions/labels/cookie-same-site</a>.</p></div></section><section id="rfc.status"><h2><a href="#rfc.status">Status of this Memo</a></h2><div id="rfc.boilerplate.1.p.1"><p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p></div><div id="rfc.boilerplate.1.p.2"><p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF). Note that other groups may also distribute working documents as Internet-Drafts. The list of current Internet-Drafts is at <a href="http://datatracker.ietf.org/drafts/current/">http://datatracker.ietf.org/drafts/current/</a>.</p></div><div id="rfc.boilerplate.1.p.3"><p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time. It is inappropriate to use Internet-Drafts as reference material or to cite them other than as “work in progress”.</p></div><div id="rfc.boilerplate.1.p.4"><p>This Internet-Draft will expire on April 4, 2018.</p></div></section><section id="rfc.copyrightnotice"><h2><a href="#rfc.copyrightnotice">Copyright Notice</a></h2><div id="rfc.boilerplate.2.p.1"><p>Copyright © 2017 IETF Trust and the persons identified as the document authors. All rights reserved.</p></div><div id="rfc.boilerplate.2.p.2"><p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of publication of this document. Please review these documents carefully, as they describe your rights and restrictions with respect to this document. Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p></div></section><section id="introduction"><h2 id="rfc.section.1" class="np"><a href="#rfc.section.1">1.</a>&nbsp;<a href="#introduction">Introduction</a></h2><div id="rfc.section.1.p.1"><p>Section 8.2 of <a href="#RFC6265"><cite title="HTTP State Management Mechanism">[RFC6265]</cite></a> eloquently notes that cookies may be employed as a form of ambient authority, attached by default to requests the user agent sends on a user’s behalf. Even when an attacker doesn’t know the contents of a user’s cookies, she can still execute commands on the user’s behalf (and with the user’s authority) by asking the user agent to send HTTP requests to unwary servers. These malicious requests will include any of the user’s previously-set cookies, and therefore can be difficult to distinguish from benign requests on the user’s behalf.</p></div><div id="rfc.section.1.p.2"><p>Here, we update <a href="#RFC6265"><cite title="HTTP State Management Mechanism">[RFC6265]</cite></a> with a simple mitigation strategy that allows servers to declare certain cookies as “same-site”, meaning they should not be attached to “cross-site” requests (as defined in section 2.1 of this specification).</p></div><div id="rfc.section.1.p.3"><p>Note that the mechanism outlined here is backwards compatible with the existing cookie syntax. Servers may serve these cookies to all user agents; those that do not support the <span class="tt">SameSite</span> attribute will simply store a cookie which is attached to all relevant requests, just as they do today.</p></div><section id="goals"><h3 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1.</a>&nbsp;<a href="#goals">Goals</a></h3><div id="rfc.section.1.1.p.1" class="avoidbreakafter"><p>Same-site cookies are intended to provide a solid layer of defense-in-depth against attacks which require embedding an authenticated request into an attacker-controlled context:</p></div><div id="rfc.section.1.1.p.2"><ol><li>Timing attacks which yield cross-origin information leakage (such as those detailed in <a href="#pixel-perfect"><cite title="Pixel Perfect Timing Attacks with HTML5">[pixel-perfect]</cite></a>) can be substantially mitigated by setting the <span class="tt">SameSite</span> attribute on authentication cookies. The attacker will only be able to embed unauthenticated resources, as embedding mechanisms such as <span class="tt">&lt;iframe&gt;</span> will yield cross-site requests.</li><li>Cross-site script inclusion (XSSI) attacks are likewise mitigated by setting the <span class="tt">SameSite</span> attribute on authentication cookies. The attacker will not be able to include authenticated resources via <span class="tt">&lt;script&gt;</span> or <span class="tt">&lt;link&gt;</span>, as these embedding mechanisms will likewise yield cross-site requests.</li><li>Cross-site request forgery (CSRF) attacks which rely on top-level navigation (HTML <span class="tt">&lt;form&gt;</span> POSTs, for instance) can also be mitigated by treating these navigational requests as “cross-site”.</li><li>Same-site cookies have some marginal value for policy or regulatory purposes, as cookies which are not delivered with cross-site requests cannot be directly used for tracking purposes. It may be valuable for an origin to assert that its cookies should not be sent along with cross-site requests in order to limit its exposure to non-technical risk.</li></ol></div></section><section id="examples"><h3 id="rfc.section.1.2"><a href="#rfc.section.1.2">1.2.</a>&nbsp;<a href="#examples">Examples</a></h3><div id="rfc.section.1.2.p.1" class="avoidbreakafter"><p>Same-site cookies are set via the <span class="tt">SameSite</span> attribute in the <span class="tt">Set-Cookie</span> header field. That is, given a server’s response to a user agent which contains the following header field:</p></div><div id="rfc.figure.u.1"><pre>
Set-Cookie: SID=31d4d96e407aad42; SameSite=Strict
</pre></div><div id="rfc.section.1.2.p.2"><p>Subsequent requests from that user agent can be expected to contain the following header field if and only if both the requested resource and the resource in the top-level browsing context match the cookie.</p></div><div id="rfc.figure.u.2"><pre>
Cookie: SID=31d4d96e407aad42
</pre></div></section></section><section id="terminology-and-notation"><h2 id="rfc.section.2"><a href="#rfc.section.2">2.</a>&nbsp;<a href="#terminology-and-notation">Terminology and notation</a></h2><div id="rfc.section.2.p.1"><p>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be interpreted as described in <a href="#RFC2119"><cite title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</cite></a>.</p></div><div id="rfc.section.2.p.2"><p>This specification uses the Augmented Backus-Naur Form (ABNF) notation of <a href="#RFC5234"><cite title="Augmented BNF for Syntax Specifications: ABNF">[RFC5234]</cite></a>.</p></div><div id="rfc.section.2.p.3"><p>Two sequences of octets are said to case-insensitively match each other if and only if they are equivalent under the <span class="tt">i;ascii-casemap</span> collation defined in <a href="#RFC4790"><cite title="Internet Application Protocol Collation Registry">[RFC4790]</cite></a>.</p></div><div id="rfc.section.2.p.4"><p>The terms “active document”, “ancestor browsing context”, “browsing context”, “dedicated worker”, “Document”, “WorkerGlobalScope”, “sandboxed origin browsing context flag”, “parent browsing context”, “shared worker”, “the worker’s Documents”, “nested browsing context”, and “top-level browsing context” are defined in <a href="#HTML"><cite title="HTML">[HTML]</cite></a>.</p></div><div id="rfc.section.2.p.5"><p>“Service Workers” are defined in the Service Workers specification <a href="#SERVICE-WORKERS"><cite title="Service Workers">[SERVICE-WORKERS]</cite></a>.</p></div><div id="rfc.section.2.p.6"><p>The term “origin”, the mechanism of deriving an origin from a URI, and the “the same” matching algorithm for origins are defined in <a href="#RFC6454"><cite title="The Web Origin Concept">[RFC6454]</cite></a>.</p></div><div id="rfc.section.2.p.7"><p>“Safe” HTTP methods include <span class="tt">GET</span>, <span class="tt">HEAD</span>, <span class="tt">OPTIONS</span>, and <span class="tt">TRACE</span>, as defined in Section 4.2.1 of <a href="#RFC7231"><cite title="Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content">[RFC7231]</cite></a>.</p></div><div id="rfc.section.2.p.8"><p>The term “public suffix” is defined in a note in Section 5.3 of <a href="#RFC6265"><cite title="HTTP State Management Mechanism">[RFC6265]</cite></a> as “a domain that is controlled by a public registry”, and are also know as “effective top-level domains” (eTLDs). For example, <span class="tt">example.com</span>’s public suffix is <span class="tt">com</span>. User agents SHOULD use an up-to-date public suffix list, such as the one maintained by Mozilla at <a href="#PSL"><cite title="Public Suffix List">[PSL]</cite></a>.</p></div><div id="rfc.section.2.p.9"><p>An origin’s “registered domain” is the origin’s host’s public suffix plus the label to its left. That is, for <span class="tt">https://www.example.com</span>, the public suffix is <span class="tt">com</span>, and the registered domain is <span class="tt">example.com</span>. This concept is defined more rigorously in <a href="#PSL"><cite title="Public Suffix List">[PSL]</cite></a>, and is also know as “effective top-level domain plus one” (eTLD+1).</p></div><div id="rfc.section.2.p.10"><p>The term “request”, as well as a request’s “client”, “current url”, “method”, and “target browsing context”, are defined in <a href="#FETCH"><cite title="Fetch">[FETCH]</cite></a>.</p></div><section id="same-site-requests"><h3 id="rfc.section.2.1"><a href="#rfc.section.2.1">2.1.</a>&nbsp;<a href="#same-site-requests">“Same-site” and “cross-site” Requests</a></h3><div id="rfc.section.2.1.p.1" class="avoidbreakafter"><p>A request is “same-site” if its target’s URI’s origin’s registered domain is an exact match for the request’s client’s “site for cookies” or if the request has no client, and “cross-site” otherwise. To be more precise, for a given request (“request”), the following algorithm returns <span class="tt">same-site</span> or <span class="tt">cross-site</span>:</p></div><div id="rfc.section.2.1.p.2"><ol><li>If <span class="tt">request</span>’s client is <span class="tt">null</span>, return <span class="tt">same-site</span>.</li><li>Let <span class="tt">site</span> be <span class="tt">request</span>’s client’s “site for cookies” (as defined in the following sections).</li><li>Let <span class="tt">target</span> be the registered domain of <span class="tt">request</span>’s current url.</li><li>If <span class="tt">site</span> is an exact match for <span class="tt">target</span>, return <span class="tt">same-site</span>.</li><li>Return <span class="tt">cross-site</span>.</li></ol></div><section id="document-requests"><h4 id="rfc.section.2.1.1"><a href="#rfc.section.2.1.1">2.1.1.</a>&nbsp;<a href="#document-requests">Document-based requests</a></h4><div id="rfc.section.2.1.1.p.1"><p>The URI displayed in a user agent’s address bar is the only security context directly exposed to users, and therefore the only signal users can reasonably rely upon to determine whether or not they trust a particular website. The registered domain of that URI’s origin represents the context in which a user most likely believes themselves to be interacting. We’ll label this domain the “top-level site”.</p></div><div id="rfc.section.2.1.1.p.2"><p>For a document displayed in a top-level browsing context, we can stop here: the document’s “site for cookies” is the top-level site.</p></div><div id="rfc.section.2.1.1.p.3"><p>For documents which are displayed in nested browsing contexts, we need to audit the origins of each of a document’s ancestor browsing contexts’ active documents in order to account for the “multiple-nested scenarios” described in Section 4 of <a href="#RFC7034"><cite title="HTTP Header Field X-Frame-Options">[RFC7034]</cite></a>. These document’s “site for cookies” is the top-level site if and only if the document and each of its ancestor documents’ origins have the same registered domain as the top-level site. Otherwise its “site for cookies” is the empty string.</p></div><div id="rfc.section.2.1.1.p.4" class="avoidbreakafter"><p>Given a Document (<span class="tt">document</span>), the following algorithm returns its “site for cookies” (either a registered domain, or the empty string):</p></div><div id="rfc.section.2.1.1.p.5"><ol><li>Let <span class="tt">top-document</span> be the active document in <span class="tt">document</span>’s browsing context’s top-level browsing context.</li><li>Let <span class="tt">top-origin</span> be the origin of <span class="tt">top-document</span>’s URI if <span class="tt">top-document</span>’s sandboxed origin browsing context flag is set, and <span class="tt">top-document</span>’s origin otherwise.</li><li>Let <span class="tt">documents</span> be a list containing <span class="tt">document</span> and each of <span class="tt">document</span>’s ancestor browsing contexts’ active documents.</li><li>For each <span class="tt">item</span> in <span class="tt">documents</span>: <ol><li>Let <span class="tt">origin</span> be the origin of <span class="tt">item</span>’s URI if <span class="tt">item</span>’s sandboxed origin browsing context flag is set, and <span class="tt">item</span>’s origin otherwise.</li><li>If <span class="tt">origin</span>’s host’s registered domain is not an exact match for <span class="tt">top-origin</span>’s host’s registered domain, return the empty string.</li></ol></li><li>Return <span class="tt">top-site</span>.</li></ol></div></section><section id="worker-requests"><h4 id="rfc.section.2.1.2"><a href="#rfc.section.2.1.2">2.1.2.</a>&nbsp;<a href="#worker-requests">Worker-based requests</a></h4><div id="rfc.section.2.1.2.p.1"><p>Worker-driven requests aren’t as clear-cut as document-driven requests, as there isn’t a clear link between a top-level browsing context and a worker. This is especially true for Service Workers <a href="#SERVICE-WORKERS"><cite title="Service Workers">[SERVICE-WORKERS]</cite></a>, which may execute code in the background, without any document visible at all.</p></div><div id="rfc.section.2.1.2.p.2"><p>Note: The descriptions below assume that workers must be same-origin with the documents that instantiate them. If this invariant changes, we’ll need to take the worker’s script’s URI into account when determining their status.</p></div><section id="dedicated-and-shared-requests"><h5 id="rfc.section.2.1.2.1"><a href="#rfc.section.2.1.2.1">2.1.2.1.</a>&nbsp;<a href="#dedicated-and-shared-requests">Dedicated and Shared Workers</a></h5><div id="rfc.section.2.1.2.1.p.1"><p>Dedicated workers are simple, as each dedicated worker is bound to one and only one document. Requests generated from a dedicated worker (via <span class="tt">importScripts</span>, <span class="tt">XMLHttpRequest</span>, <span class="tt">fetch()</span>, etc) define their “site for cookies” as that document’s “site for cookies”.</p></div><div id="rfc.section.2.1.2.1.p.2"><p>Shared workers may be bound to multiple documents at once. As it is quite possible for those documents to have distinct “site for cookie” values, the worker’s “site for cookies” will be the empty string in cases where the values diverge, and the shared value in cases where the values agree.</p></div><div id="rfc.section.2.1.2.1.p.3" class="avoidbreakafter"><p>Given a WorkerGlobalScope (<span class="tt">worker</span>), the following algorithm returns its “site for cookies” (either a registered domain, or the empty string):</p></div><div id="rfc.section.2.1.2.1.p.4"><ol><li>Let <span class="tt">site</span> be <span class="tt">worker</span>’s origin’s host’s registered domain.</li><li>For each <span class="tt">document</span> in <span class="tt">worker</span>’s Documents: <ol><li>Let <span class="tt">document-site</span> be <span class="tt">document</span>’s “site for cookies” (as defined in <a href="#document-requests" title="Document-based requests">Section&nbsp;2.1.1</a>).</li><li>If <span class="tt">document-site</span> is not an exact match for <span class="tt">site</span>, return the empty string.</li></ol></li><li>Return <span class="tt">site</span>.</li></ol></div></section><section id="service-workers"><h5 id="rfc.section.2.1.2.2"><a href="#rfc.section.2.1.2.2">2.1.2.2.</a>&nbsp;<a href="#service-workers">Service Workers</a></h5><div id="rfc.section.2.1.2.2.p.1"><p>Service Workers are more complicated, as they act as a completely separate execution context with only tangential relationship to the Document which registered them.</p></div><div id="rfc.section.2.1.2.2.p.2"><p>Requests which simply pass through a service worker will be handled as described above: the request’s client will be the Document or Worker which initiated the request, and its “site for cookies” will be those defined in <a href="#document-requests" title="Document-based requests">Section&nbsp;2.1.1</a> and <a href="#dedicated-and-shared-requests" title="Dedicated and Shared Workers">Section&nbsp;2.1.2.1</a></p></div><div id="rfc.section.2.1.2.2.p.3"><p>Requests which are initiated by the Service Worker itself (via a direct call to <span class="tt">fetch()</span>, for instance), on the other hand, will have a client which is a ServiceWorkerGlobalScope. Its “site for cookies” will be the registered domain of the Service Worker’s URI.</p></div><div id="rfc.section.2.1.2.2.p.4" class="avoidbreakafter"><p>Given a ServiceWorkerGlobalScope (<span class="tt">worker</span>), the following algorithm returns its “site for cookies” (either a registered domain, or the empty string):</p></div><div id="rfc.section.2.1.2.2.p.5"><ol><li>Return <span class="tt">worker</span>’s origin’s host’s registered domain.</li></ol></div></section></section></section></section><section id="server-requirements"><h2 id="rfc.section.3"><a href="#rfc.section.3">3.</a>&nbsp;<a href="#server-requirements">Server Requirements</a></h2><div id="rfc.section.3.p.1"><p>This section describes extensions to <a href="#RFC6265"><cite title="HTTP State Management Mechanism">[RFC6265]</cite></a> necessary to implement the server-side requirements of the <span class="tt">SameSite</span> attribute.</p></div><section id="grammar"><h3 id="rfc.section.3.1"><a href="#rfc.section.3.1">3.1.</a>&nbsp;<a href="#grammar">Grammar</a></h3><div id="rfc.section.3.1.p.1" class="avoidbreakafter"><p>Add <span class="tt">SameSite</span> to the list of accepted attributes in the <span class="tt">Set-Cookie</span> header field’s value by replacing the <span class="tt">cookie-av</span> token definition in Section 4.1.1 of <a href="#RFC6265"><cite title="HTTP State Management Mechanism">[RFC6265]</cite></a> with the following ABNF grammar:</p></div><div id="rfc.figure.u.3"><pre>
cookie-av      = expires-av / max-age-av / domain-av /
                 path-av / secure-av / httponly-av /
                 samesite-av / extension-av
samesite-av    = "SameSite=" samesite-value
samesite-value = "Strict" / "Lax"
</pre></div></section><section id="semantics-of-the-samesite-attribute-non-normative"><h3 id="rfc.section.3.2"><a href="#rfc.section.3.2">3.2.</a>&nbsp;<a href="#semantics-of-the-samesite-attribute-non-normative">Semantics of the “SameSite” Attribute (Non-Normative)</a></h3><div id="rfc.section.3.2.p.1"><p>The “SameSite” attribute limits the scope of the cookie such that it will only be attached to requests if those requests are same-site, as defined by the algorithm in <a href="#same-site-requests" title="“Same-site” and “cross-site” Requests">Section&nbsp;2.1</a>. For example, requests for <span class="tt">https://example.com/sekrit-image</span> will attach same-site cookies if and only if initiated from a context whose “site for cookies” is “example.com”.</p></div><div id="rfc.section.3.2.p.2"><p>If the “SameSite” attribute’s value is “Strict”, the cookie will only be sent along with “same-site” requests. If the value is “Lax”, the cookie will be sent with same-site requests, and with “cross-site” top-level navigations, as described in <a href="#strict-lax" title="“Strict” and “Lax” enforcement">Section&nbsp;4.1.1</a>. If the “SameSite” attribute’s value is neither of these, the cookie will be ignored.</p></div><div id="rfc.section.3.2.p.3"><p>The changes to the <span class="tt">Cookie</span> header field suggested in <a href="#cookie-header" title="Monkey-patching the “Cookie” header">Section&nbsp;4.3</a> provide additional detail.</p></div></section></section><section id="user-agent-requirements"><h2 id="rfc.section.4"><a href="#rfc.section.4">4.</a>&nbsp;<a href="#user-agent-requirements">User Agent Requirements</a></h2><div id="rfc.section.4.p.1"><p>This section describes extensions to <a href="#RFC6265"><cite title="HTTP State Management Mechanism">[RFC6265]</cite></a> necessary in order to implement the client-side requirements of the <span class="tt">SameSite</span> attribute.</p></div><section id="the-samesite-attribute"><h3 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1.</a>&nbsp;<a href="#the-samesite-attribute">The “SameSite” attribute</a></h3><div id="rfc.section.4.1.p.1" class="avoidbreakafter"><p>The following attribute definition should be considered part of the the <span class="tt">Set-Cookie</span> algorithm as described in Section 5.2 of <a href="#RFC6265"><cite title="HTTP State Management Mechanism">[RFC6265]</cite></a>:</p></div><div id="rfc.section.4.1.p.2" class="avoidbreakafter"><p>If the <span class="tt">attribute-name</span> case-insensitively matches the string “SameSite”, the user agent MUST process the <span class="tt">cookie-av</span> as follows:</p></div><div id="rfc.section.4.1.p.3"><ol><li>If <span class="tt">cookie-av</span>’s <span class="tt">attribute-value</span> is not a case-insensitive match for “Strict” or “Lax”, ignore the <span class="tt">cookie-av</span>.</li><li>Let <span class="tt">enforcement</span> be “Lax” if <span class="tt">cookie-av</span>’s <span class="tt">attribute-value</span> is a case-insensitive match for “Lax”, and “Strict” otherwise.</li><li>Append an attribute to the <span class="tt">cookie-attribute-list</span> with an <span class="tt">attribute-name</span> of “SameSite” and an <span class="tt">attribute-value</span> of <span class="tt">enforcement</span>.</li></ol></div><section id="strict-lax"><h4 id="rfc.section.4.1.1"><a href="#rfc.section.4.1.1">4.1.1.</a>&nbsp;<a href="#strict-lax">“Strict” and “Lax” enforcement</a></h4><div id="rfc.section.4.1.1.p.1"><p>Same-site cookies in “Strict” enforcement mode will not be sent along with top-level navigations which are triggered from a cross-site document context. As discussed in <a href="#top-level-navigations" title="Top-level Navigations">Section&nbsp;5.2</a>, this might or might not be compatible with existing session management systems. In the interests of providing a drop-in mechanism that mitigates the risk of CSRF attacks, developers may set the <span class="tt">SameSite</span> attribute in a “Lax” enforcement mode that carves out an exception which sends same-site cookies along with cross-site requests if and only if they are top-level navigations which use a “safe” (in the <a href="#RFC7231"><cite title="Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content">[RFC7231]</cite></a> sense) HTTP method.</p></div><div id="rfc.section.4.1.1.p.2" class="avoidbreakafter"><p>Lax enforcement provides reasonable defense in depth against CSRF attacks that rely on unsafe HTTP methods (like <span class="tt">POST</span>), but does not offer a robust defense against CSRF as a general category of attack:</p></div><div id="rfc.section.4.1.1.p.3"><ol><li>Attackers can still pop up new windows or trigger top-level navigations in order to create a “same-site” request (as described in section 2.1), which is only a speedbump along the road to exploitation.</li><li>Features like <span class="tt">&lt;link rel='prerender'&gt;</span> <a href="#prerendering"><cite title="Chrome Prerendering">[prerendering]</cite></a> can be exploited to create “same-site” requests without the risk of user detection.</li></ol></div><div id="rfc.section.4.1.1.p.4"><p>When possible, developers should use a session management mechanism such as that described in <a href="#top-level-navigations" title="Top-level Navigations">Section&nbsp;5.2</a> to mitigate the risk of CSRF more completely.</p></div></section></section><section id="monkey-patching-the-storage-model"><h3 id="rfc.section.4.2"><a href="#rfc.section.4.2">4.2.</a>&nbsp;<a href="#monkey-patching-the-storage-model">Monkey-patching the Storage Model</a></h3><div id="rfc.section.4.2.p.1"><p>Note: There’s got to be a better way to specify this. Until I figure out what that is, monkey-patching!</p></div><div id="rfc.section.4.2.p.2" class="avoidbreakafter"><p>Alter Section 5.3 of <a href="#RFC6265"><cite title="HTTP State Management Mechanism">[RFC6265]</cite></a> as follows:</p></div><div id="rfc.section.4.2.p.3"><ol><li>Add <span class="tt">samesite-flag</span> to the list of each cookie’s fields defined in the first paragraph. Note: this field’s value is one of “None”, “Strict”, or “Lax”.</li><li>Before step 11 of the current algorithm, add the following: <ol><li>If the <span class="tt">cookie-attribute-list</span> contains an attribute with an <span class="tt">attribute-name</span> of “SameSite”, set the cookie’s <span class="tt">samesite-flag</span> to <span class="tt">attribute-value</span> (“Strict” or “Lax”). Otherwise, set the cookie’s <span class="tt">samesite-flag</span> to “None”.</li><li>If the cookie’s <span class="tt">samesite-flag</span> is not “None”, and the request which generated the cookie’s client’s “site for cookies” is not an exact match for <span class="tt">request-uri</span>’s host’s registered domain, then abort these steps and ignore the newly created cookie entirely.</li></ol></li></ol></div></section><section id="cookie-header"><h3 id="rfc.section.4.3"><a href="#rfc.section.4.3">4.3.</a>&nbsp;<a href="#cookie-header">Monkey-patching the “Cookie” header</a></h3><div id="rfc.section.4.3.p.1"><p>Note: There’s got to be a better way to specify this. Until I figure out what that is, monkey-patching!</p></div><div id="rfc.section.4.3.p.2" class="avoidbreakafter"><p>Alter Section 5.4 of <a href="#RFC6265"><cite title="HTTP State Management Mechanism">[RFC6265]</cite></a> as follows:</p></div><div id="rfc.section.4.3.p.3"><ol><li>Add the following requirement to the end of the bulleted list in step 1: <ul><li>If the cookie’s <span class="tt">samesite-flag</span> is not “None”, and the HTTP request is cross-site (as defined in <a href="#same-site-requests" title="“Same-site” and “cross-site” Requests">Section&nbsp;2.1</a>) then exclude the cookie unless all of the following statements hold: <ol><li><span class="tt">samesite-flag</span> is “Lax”</li><li>The HTTP request’s method is “safe”.</li><li>The HTTP request’s target browsing context is a top-level browsing context.</li></ol></li></ul></li></ol></div><div id="rfc.section.4.3.p.4"><p>Note that the modifications suggested here concern themselves only with the “site for cookies” of the request’s client, and the registered domain of the resource being requested. The cookie’s <span class="tt">domain</span>, <span class="tt">path</span>, and <span class="tt">secure</span> attributes do not come into play for these comparisons.</p></div></section></section><section id="authoring-considerations"><h2 id="rfc.section.5"><a href="#rfc.section.5">5.</a>&nbsp;<a href="#authoring-considerations">Authoring Considerations</a></h2><section id="defense-in-depth"><h3 id="rfc.section.5.1"><a href="#rfc.section.5.1">5.1.</a>&nbsp;<a href="#defense-in-depth">Defense in depth</a></h3><div id="rfc.section.5.1.p.1"><p>“SameSite” cookies offer a robust defense against CSRF attack when deployed in strict mode, and when supported by the client. It is, however, prudent to ensure that this designation is not the extent of a site’s defense against CSRF, as same-site navigations and submissions can certainly be executed in conjunction with other attack vectors such as cross-site scripting.</p></div><div id="rfc.section.5.1.p.2"><p>Developers are strongly encouraged to deploy the usual server-side defenses (CSRF tokens, ensuring that “safe” HTTP methods are idempotent, etc) to mitigate the risk more fully.</p></div><div id="rfc.section.5.1.p.3"><p>Additionally, client-side techniques such as those described in <a href="#app-isolation"><cite title="App Isolation - Get the Security of Multiple Browsers with Just One">[app-isolation]</cite></a> may also prove effective against CSRF, and are certainly worth exploring in combination with “SameSite” cookies.</p></div></section><section id="top-level-navigations"><h3 id="rfc.section.5.2"><a href="#rfc.section.5.2">5.2.</a>&nbsp;<a href="#top-level-navigations">Top-level Navigations</a></h3><div id="rfc.section.5.2.p.1"><p>Setting the <span class="tt">SameSite</span> attribute in “strict” mode provides robust defense in depth against CSRF attacks, but has the potential to confuse users unless sites’ developers carefully ensure that their cookie-based session management systems deal reasonably well with top-level navigations.</p></div><div id="rfc.section.5.2.p.2"><p>Consider the scenario in which a user reads their email at MegaCorp Inc’s webmail provider <span class="tt">https://example.com/</span>. They might expect that clicking on an emailed link to <span class="tt">https://projects.com/secret/project</span> would show them the secret project that they’re authorized to see, but if <span class="tt">projects.com</span> has marked their session cookies as <span class="tt">SameSite</span>, then this cross-site navigation won’t send them along with the request. <span class="tt">projects.com</span> will render a 404 error to avoid leaking secret information, and the user will be quite confused.</p></div><div id="rfc.section.5.2.p.3"><p>Developers can avoid this confusion by adopting a session management system that relies on not one, but two cookies: one conceptually granting “read” access, another granting “write” access. The latter could be marked as <span class="tt">SameSite</span>, and its absence would prompt a reauthentication step before executing any non-idempotent action. The former could drop the <span class="tt">SameSite</span> attribute entirely, or choose the “Lax” version of enforcement, in order to allow users access to data via top-level navigation.</p></div></section><section id="mashups-and-widgets"><h3 id="rfc.section.5.3"><a href="#rfc.section.5.3">5.3.</a>&nbsp;<a href="#mashups-and-widgets">Mashups and Widgets</a></h3><div id="rfc.section.5.3.p.1"><p>The <span class="tt">SameSite</span> attribute is inappropriate for some important use-cases. In particular, note that content intended for embedding in a cross-site contexts (social networking widgets or commenting services, for instance) will not have access to same-site cookies. Cookies may be required for requests triggered in these cross-site contexts in order to provide seamless functionality that relies on a user’s state.</p></div><div id="rfc.section.5.3.p.2"><p>Likewise, some forms of Single-Sign-On might require cookie-based authentication in a cross-site context; these mechanisms will not function as intended with same-site cookies.</p></div></section></section><section id="privacy-considerations"><h2 id="rfc.section.6"><a href="#rfc.section.6">6.</a>&nbsp;<a href="#privacy-considerations">Privacy Considerations</a></h2><section id="server-controlled"><h3 id="rfc.section.6.1"><a href="#rfc.section.6.1">6.1.</a>&nbsp;<a href="#server-controlled">Server-controlled</a></h3><div id="rfc.section.6.1.p.1"><p>Same-site cookies in and of themselves don’t do anything to address the general privacy concerns outlined in Section 7.1 of <a href="#RFC6265"><cite title="HTTP State Management Mechanism">[RFC6265]</cite></a>. The SameSite attribute is set by the server, and serves to mitigate the risk of certain kinds of attacks that the server is worried about. The user is not involved in this decision. Moreover, a number of side-channels exist which could allow a server to link distinct requests even in the absence of cookies. Connection and/or socket pooling, Token Binding, and Channel ID all offer explicit methods of identification that servers could take advantage of.</p></div></section><section id="pervasive-monitoring"><h3 id="rfc.section.6.2"><a href="#rfc.section.6.2">6.2.</a>&nbsp;<a href="#pervasive-monitoring">Pervasive Monitoring</a></h3><div id="rfc.section.6.2.p.1"><p>As outlined in <a href="#RFC7258"><cite title="Pervasive Monitoring Is an Attack">[RFC7258]</cite></a>, pervasive monitoring is an attack. Cookies play a large part in enabling such monitoring, as they are responsible for maintaining state in HTTP connections. We considered restricting same-site cookies to secure contexts <a href="#secure-contexts"><cite title="Secure Contexts">[secure-contexts]</cite></a> as a mitigation but decided against doing so, as same-site cookies should result in a strict reduction in the number of cookies floating around in cross-site contexts. That is, even if <span class="tt">http://not-example.com</span> embeds a resource from <span class="tt">http://example.com/</span>, that resource will not be “same-site”, and <span class="tt">http://example.com</span>’s cookies simply cannot be used to correlate user behavior across distinct origins.</p></div></section></section><section id="rfc.references"><h2 id="rfc.section.7"><a href="#rfc.section.7">7.</a> References</h2><section id="rfc.references.1"><h3 id="rfc.section.7.1"><a href="#rfc.section.7.1">7.1.</a> Normative References</h3><dl class="dl-horizontal"><dt id="FETCH">[FETCH]</dt><dd>van Kesteren, A., “<a href="https://fetch.spec.whatwg.org/">Fetch</a>”, n.d., &lt;<a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>&gt;.</dd><dt id="HTML">[HTML]</dt><dd>Hickson, I., Pieters, S., van Kesteren, A., Jägenstedt, P., and D. Denicola, “<a href="https://html.spec.whatwg.org/">HTML</a>”, n.d., &lt;<a href="https://html.spec.whatwg.org/">https://html.spec.whatwg.org/</a>&gt;.</dd><dt id="PSL">[PSL]</dt><dd>“<a href="https://publicsuffix.org/list/">Public Suffix List</a>”, n.d., &lt;<a href="https://publicsuffix.org/list/">https://publicsuffix.org/list/</a>&gt;.</dd><dt id="RFC2119">[RFC2119]</dt><dd>Bradner, S., “<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>”, BCP&nbsp;14, RFC&nbsp;2119, <a href="http://dx.doi.org/10.17487/RFC2119">DOI&nbsp;10.17487/RFC2119</a>, March&nbsp;1997, &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.</dd><dt id="RFC4790">[RFC4790]</dt><dd>Newman, C., Duerst, M., and A. Gulbrandsen, “<a href="https://tools.ietf.org/html/rfc4790">Internet Application Protocol Collation Registry</a>”, RFC&nbsp;4790, <a href="http://dx.doi.org/10.17487/RFC4790">DOI&nbsp;10.17487/RFC4790</a>, March&nbsp;2007, &lt;<a href="https://www.rfc-editor.org/info/rfc4790">https://www.rfc-editor.org/info/rfc4790</a>&gt;.</dd><dt id="RFC5234">[RFC5234]</dt><dd>Crocker, D., Ed. and P. Overell, “<a href="https://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>”, STD&nbsp;68, RFC&nbsp;5234, <a href="http://dx.doi.org/10.17487/RFC5234">DOI&nbsp;10.17487/RFC5234</a>, January&nbsp;2008, &lt;<a href="https://www.rfc-editor.org/info/rfc5234">https://www.rfc-editor.org/info/rfc5234</a>&gt;.</dd><dt id="RFC6265">[RFC6265]</dt><dd>Barth, A., “<a href="https://tools.ietf.org/html/rfc6265">HTTP State Management Mechanism</a>”, RFC&nbsp;6265, <a href="http://dx.doi.org/10.17487/RFC6265">DOI&nbsp;10.17487/RFC6265</a>, April&nbsp;2011, &lt;<a href="https://www.rfc-editor.org/info/rfc6265">https://www.rfc-editor.org/info/rfc6265</a>&gt;.</dd><dt id="RFC6454">[RFC6454]</dt><dd>Barth, A., “<a href="https://tools.ietf.org/html/rfc6454">The Web Origin Concept</a>”, RFC&nbsp;6454, <a href="http://dx.doi.org/10.17487/RFC6454">DOI&nbsp;10.17487/RFC6454</a>, December&nbsp;2011, &lt;<a href="https://www.rfc-editor.org/info/rfc6454">https://www.rfc-editor.org/info/rfc6454</a>&gt;.</dd><dt id="RFC7231">[RFC7231]</dt><dd>Fielding, R., Ed. and J. Reschke, Ed., “<a href="https://tools.ietf.org/html/rfc7231">Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content</a>”, RFC&nbsp;7231, <a href="http://dx.doi.org/10.17487/RFC7231">DOI&nbsp;10.17487/RFC7231</a>, June&nbsp;2014, &lt;<a href="https://www.rfc-editor.org/info/rfc7231">https://www.rfc-editor.org/info/rfc7231</a>&gt;.</dd><dt id="RFC7258">[RFC7258]</dt><dd>Farrell, S. and H. Tschofenig, “<a href="https://tools.ietf.org/html/rfc7258">Pervasive Monitoring Is an Attack</a>”, BCP&nbsp;188, RFC&nbsp;7258, <a href="http://dx.doi.org/10.17487/RFC7258">DOI&nbsp;10.17487/RFC7258</a>, May&nbsp;2014, &lt;<a href="https://www.rfc-editor.org/info/rfc7258">https://www.rfc-editor.org/info/rfc7258</a>&gt;.</dd><dt id="SERVICE-WORKERS">[SERVICE-WORKERS]</dt><dd>Russell, A., Song, J., and J. Archibald, “<a href="http://www.w3.org/TR/service-workers/">Service Workers</a>”, n.d., &lt;<a href="http://www.w3.org/TR/service-workers/">http://www.w3.org/TR/service-workers/</a>&gt;.</dd></dl></section><section id="rfc.references.2"><h3 id="rfc.section.7.2"><a href="#rfc.section.7.2">7.2.</a> Informative References</h3><dl class="dl-horizontal"><dt id="RFC7034">[RFC7034]</dt><dd>Ross, D. and T. Gondrom, “<a href="https://tools.ietf.org/html/rfc7034">HTTP Header Field X-Frame-Options</a>”, RFC&nbsp;7034, <a href="http://dx.doi.org/10.17487/RFC7034">DOI&nbsp;10.17487/RFC7034</a>, October&nbsp;2013, &lt;<a href="https://www.rfc-editor.org/info/rfc7034">https://www.rfc-editor.org/info/rfc7034</a>&gt;.</dd><dt id="app-isolation">[app-isolation]</dt><dd>Chen, E., Bau, J., Reis, C., Barth, A., and C. Jackson, “<a href="http://www.collinjackson.com/research/papers/appisolation.pdf">App Isolation - Get the Security of Multiple Browsers with Just One</a>”, 2011, &lt;<a href="http://www.collinjackson.com/research/papers/appisolation.pdf">http://www.collinjackson.com/research/papers/appisolation.pdf</a>&gt;.</dd><dt id="pixel-perfect">[pixel-perfect]</dt><dd>Stone, P., “<a href="http://www.contextis.com/documents/2/Browser_Timing_Attacks.pdf">Pixel Perfect Timing Attacks with HTML5</a>”, n.d., &lt;<a href="http://www.contextis.com/documents/2/Browser_Timing_Attacks.pdf">http://www.contextis.com/documents/2/Browser_Timing_Attacks.pdf</a>&gt;.</dd><dt id="prerendering">[prerendering]</dt><dd>Bentzel, C., “<a href="https://www.chromium.org/developers/design-documents/prerender">Chrome Prerendering</a>”, n.d., &lt;<a href="https://www.chromium.org/developers/design-documents/prerender">https://www.chromium.org/developers/design-documents/prerender</a>&gt;.</dd><dt id="samedomain-cookies">[samedomain-cookies]</dt><dd>Goodwin, M. and J. Walker, “<a href="http://people.mozilla.org/~mgoodwin/SameDomain/samedomain-latest.txt">SameDomain Cookie Flag</a>”, 2011, &lt;<a href="http://people.mozilla.org/~mgoodwin/SameDomain/samedomain-latest.txt">http://people.mozilla.org/~mgoodwin/SameDomain/samedomain-latest.txt</a>&gt;.</dd><dt id="secure-contexts">[secure-contexts]</dt><dd>West, M., “<a href="https://w3c.github.io/webappsec-secure-contexts/">Secure Contexts</a>”, n.d., &lt;<a href="https://w3c.github.io/webappsec-secure-contexts/">https://w3c.github.io/webappsec-secure-contexts/</a>&gt;.</dd></dl></section></section><section id="changes-since-draft-ietf-httpbis-cookie-same-site-00"><h2 id="rfc.section.A" class="np"><a href="#rfc.section.A">A.</a>&nbsp;<a href="#changes-since-draft-ietf-httpbis-cookie-same-site-00">Changes since draft-ietf-httpbis-cookie-same-site-00</a></h2><div id="rfc.section.A.p.1"><ol><li>Cookies whose “SameSite” attribute’s value is neither “Strict” nor “Lax” are ignored.</li></ol></div></section><section id="acknowledgements"><h2 id="rfc.section.B"><a href="#rfc.section.B">B.</a>&nbsp;<a href="#acknowledgements">Acknowledgements</a></h2><div id="rfc.section.B.p.1"><p>The same-site cookie concept documented here is indebited to Mark Goodwin’s and Joe Walker’s <a href="#samedomain-cookies"><cite title="SameDomain Cookie Flag">[samedomain-cookies]</cite></a>. Michal Zalewski, Artur Janc, Ryan Sleevi, Adam Barth, and Jeff Hodges provided particularly valuable feedback on this document.</p></div></section><section id="rfc.authors" class="avoidbreakinside"><h2><a href="#rfc.authors">Authors' Addresses</a></h2><address><b>Mike West</b><br>Google, Inc<br>EMail: <a href="mailto:mkwst@google.com">mkwst@google.com</a><br>URI: <a href="https://mikewest.org/">https://mikewest.org/</a></address><address><b>Mark Goodwin</b><br>Mozilla<br>EMail: <a href="mailto:mgoodwin@mozilla.com">mgoodwin@mozilla.com</a><br>URI: <a href="https://www.computerist.org/">https://www.computerist.org/</a></address></section></div></div></div><script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script></body></html>